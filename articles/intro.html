<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with writing `{tidymodules}` • tidymodules</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with writing `{tidymodules}`">
<meta property="og:description" content="tidymodules">
<meta property="og:image" content="https://opensource.nibr.com/tidymodules/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidymodules</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/tidymodules.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Writing R6 classes and tidymodules</a>
    </li>
    <li>
      <a href="../articles/namespace.html">Namespace management</a>
    </li>
    <li>
      <a href="../articles/communication.html">Cross module communication</a>
    </li>
    <li>
      <a href="../articles/inheritance.html">Inheritance</a>
    </li>
    <li>
      <a href="../articles/session.html">Session management</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Novartis/tidymodules/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with writing
<code>{tidymodules}</code>
</h1>
            <h3 data-toc-skip class="subtitle"><i style="color:#285fa4;" class="fas fa-laptop-code fa-4x"></i></h3>
                        <h4 data-toc-skip class="author">Xiao Ni,
Mustapha Larbaoui</h4>
            
            <h4 data-toc-skip class="date">2023-02-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Novartis/tidymodules/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="a-quick-introduction-to-r6-and-object-oriented-programming-oop">A quick introduction to R6 and Object Oriented Programming
(OOP)<a class="anchor" aria-label="anchor" href="#a-quick-introduction-to-r6-and-object-oriented-programming-oop"></a>
</h2>
<p><a href="https://github.com/Novartis/tidymodules" class="external-link">tidymodules</a> or <a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a> in short, is based on
R6 (<a href="https://r6.r-lib.org/" class="external-link">https://r6.r-lib.org/</a>), which is
an implementation of encapsulated object-oriented programming for R.
Therefore knowledge of R6 is a prerequisite to develop <a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a>
modules.</p>
<p>R6 provides a framework for OOP in R. Unlike the functional
programming style, R6 encapsulates methods and fields in classes that
instantiate into objects. R6 classes are similar to R’s reference
classes, but are more efficient and do not depend on S4 classes and the
methods package.</p>
<p>This vignette provides a brief overview of R6 for developers new to
R6. For more information, developers are recommended to review the R6
packagedown site (<a href="https://r6.r-lib.org/" class="external-link">https://r6.r-lib.org/</a>), as well as
Chapter 14 of the Advanced R book (<a href="https://adv-r.hadley.nz/r6.html" class="external-link">https://adv-r.hadley.nz/r6.html</a>)</p>
<div class="section level3">
<h3 id="r6-classes-and-methods">R6 classes and methods<a class="anchor" aria-label="anchor" href="#r6-classes-and-methods"></a>
</h3>
<p><a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a> depends on the R6 package which you can install
from CRAN and load:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r6.r-lib.org" class="external-link">R6</a></span><span class="op">)</span></span></code></pre></div>
<p>R6 classes are created using the <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link"><code>R6::R6Class()</code>
function</a>, which is the only function from the R6 package that is
typically used. The following is a simple example of defining an R6
class:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Calculator</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  classname <span class="op">=</span> <span class="st">"Calculator"</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    value <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">self</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="op">}</span>,</span>
<span>    add <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">self</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="va">x</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The first argument <code>classname</code> by convention uses
<code>UpperCamelCase</code>. The second argument <code>public</code>
encapsulates a list of methods (functions) and fields (objects) that
make up the public interface of the object. By convention methods and
fields use <code>snake_case</code>. Methods can access the methods and
fields of the current object using <code>self$</code>. One should always
assign the result of <code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class()</a></code> into a variable with the
same names as the <code>classname</code> because <code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class()</a></code>
returns an R6 object that defines the class.</p>
<p>You can print the class definition:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Calculator</span></span>
<span><span class="co">#&gt; &lt;Calculator&gt; object generator</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     value: NA</span></span>
<span><span class="co">#&gt;     initialize: function (value) </span></span>
<span><span class="co">#&gt;     add: function (x = 1) </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;   Parent env: &lt;environment: R_GlobalEnv&gt;</span></span>
<span><span class="co">#&gt;   Locked objects: TRUE</span></span>
<span><span class="co">#&gt;   Locked class: FALSE</span></span>
<span><span class="co">#&gt;   Portable: TRUE</span></span></code></pre></div>
<p>To create a new instance of <code>Calculator</code>, use the
<code>$new()</code> method. The <code>$initialize()</code> is an
important method, which overrides the default behavior of
<code>$new()</code>. In the above example, the
<code>$initialize()</code> method initializes the
<code>calculator1</code> object with <code>value = 0</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calculator1</span> <span class="op">&lt;-</span> <span class="va">Calculator</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">calculator1</span></span>
<span><span class="co">#&gt; &lt;Calculator&gt;</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     add: function (x = 1) </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     initialize: function (value) </span></span>
<span><span class="co">#&gt;     value: 0</span></span></code></pre></div>
<p>You can then call the methods and access fields using
<code>$</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calculator1</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">calculator1</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>You can also add methods after class creation as illustrated below
for the existing <code>Calculator</code> R6 class, although new methods
and fields are only available to new objects.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Calculator</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span><span class="st">"public"</span>, <span class="st">"subtract"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">self</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="va">value</span> <span class="op">-</span> <span class="va">x</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">Calculator</span></span>
<span><span class="co">#&gt; &lt;Calculator&gt; object generator</span></span>
<span><span class="co">#&gt;   Public:</span></span>
<span><span class="co">#&gt;     value: NA</span></span>
<span><span class="co">#&gt;     initialize: function (value) </span></span>
<span><span class="co">#&gt;     add: function (x = 1) </span></span>
<span><span class="co">#&gt;     clone: function (deep = FALSE) </span></span>
<span><span class="co">#&gt;     subtract: function (x = 1) </span></span>
<span><span class="co">#&gt;   Parent env: &lt;environment: R_GlobalEnv&gt;</span></span>
<span><span class="co">#&gt;   Locked objects: TRUE</span></span>
<span><span class="co">#&gt;   Locked class: FALSE</span></span>
<span><span class="co">#&gt;   Portable: TRUE</span></span></code></pre></div>
<p>Below are some key features of R6.</p>
<ul>
<li>
<strong>Reference semantics</strong>: objects are not copied when
modified. R6 provides a <code>$clone()</code> method for making copy of
an object. For more details, refer to <a href="https://r6.r-lib.org/reference/R6Class.html#cloning-objects" class="external-link uri">https://r6.r-lib.org/reference/R6Class.html#cloning-objects</a>.</li>
<li>
<strong>Public vs. private members</strong>: <code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class()</a></code>
has a <code>private</code> argument for you to define private methods
and fileds that can only be accessed from within the class, not from the
outside.</li>
<li>
<strong>Inheritance</strong>: as in classical OOP, one R6 class can
inherit from another R6 class. Superclass methods can be accessed with
<code>super$</code>.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="tidymodulestidymodule-class">
<code>tidymodules::TidyModule</code> class<a class="anchor" aria-label="anchor" href="#tidymodulestidymodule-class"></a>
</h2>
<p>The <code><a href="../reference/TidyModule.html">tidymodules::TidyModule</a></code> class is a R6 class and the
parent of all <a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a> modules.</p>
<p>Below is partial code of the <code>TidyModule</code> class for
illustration purpose. The <code>TidyModule</code> class includes many
public methods. There are utility functions such as
<code><a href="../reference/callModules.html">callModules()</a></code>, <code>definePorts()</code>,
<code>assignPort()</code> as well as functions that need to be
overwritten such as <code>ui()</code>, <code>server()</code>, etc.</p>
<p>Unlike conventional Shiny modules in funtional programming style,
<a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a> encapsulates functions such as ui() and server() as
methods in a TidyModule class object. Module namespace ID is seamlessly
managed within the module class for the ui and server. For complete
technical documentation that includes other methods and fields, see
<code><a href="../reference/TidyModule.html">?TidyModule</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TidyModule</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  <span class="st">"TidyModule"</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    module_ns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    parent_ns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    parent_mod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    parent_ports <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    created <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    o <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    i <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">inherit</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">group</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># details omitted</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="co"># Other methods such</span></span>
<span>    ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>,</span>
<span>                      <span class="va">output</span>,</span>
<span>                      <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Need to isolate this block to avoid unecessary triggers</span></span>
<span>      <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/isolate.html" class="external-link">isolate</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">shiny_session</span> <span class="op">&lt;-</span> <span class="va">session</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">shiny_input</span> <span class="op">&lt;-</span> <span class="va">input</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">shiny_output</span> <span class="op">&lt;-</span> <span class="va">output</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    definePort <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/isolate.html" class="external-link">isolate</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    assignPort <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/observe.html" class="external-link">observe</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/isolate.html" class="external-link">isolate</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="co"># Other public methods omitted</span></span>
<span>  <span class="op">)</span>,</span>
<span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="co"># Details omitted</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="writing-your-first-tm-module">Writing your first <code>{tm}</code> module<a class="anchor" aria-label="anchor" href="#writing-your-first-tm-module"></a>
</h2>
<p>You can develop new <a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a> modules by inheriting and
extending the <code><a href="../reference/TidyModule.html">tidymodules::TidyModule</a></code> class.</p>
<p>Below is a minimal example, <code>RandomNumberGenerator</code>,
defined with one input port and one output port. The input port is a
random number seed that feeds into a random number generator, whose
result serves as the module output.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Module definition</span></span>
<span><span class="va">RandomNumMod</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  <span class="st">"RandomNumGenerator"</span>,</span>
<span>  inherit <span class="op">=</span> <span class="fu">tidymodules</span><span class="fu">::</span><span class="va"><a href="../reference/TidyModule.html">TidyModule</a></span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">super</span><span class="op">$</span><span class="fu">initialize</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">self</span><span class="op">$</span><span class="fu">definePort</span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="fu">addInputPort</span><span class="op">(</span></span>
<span>          name <span class="op">=</span> <span class="st">"seed"</span>,</span>
<span>          description <span class="op">=</span> <span class="st">"random number seed"</span>,</span>
<span>          sample <span class="op">=</span> <span class="fl">123</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="fu">addOutputPort</span><span class="op">(</span></span>
<span>          name <span class="op">=</span> <span class="st">"number"</span>,</span>
<span>          description <span class="op">=</span> <span class="st">"Random number"</span>,</span>
<span>          sample <span class="op">=</span> <span class="fl">123</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">tagList</span><span class="op">(</span></span>
<span>        <span class="fu">verbatimTextOutput</span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="fu">ns</span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">super</span><span class="op">$</span><span class="fu">server</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">reactive</span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">s</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">getInput</span><span class="op">(</span><span class="st">"seed"</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fu">s</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1e5</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">output</span><span class="op">$</span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu">renderPrint</span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">s</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="fu">getInput</span><span class="op">(</span><span class="st">"seed"</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"seed = "</span>, <span class="fu">s</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"number = "</span>, <span class="fu">result</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">self</span><span class="op">$</span><span class="fu">assignPort</span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="fu">updateOutputPort</span><span class="op">(</span></span>
<span>          id <span class="op">=</span> <span class="st">"number"</span>,</span>
<span>          output <span class="op">=</span> <span class="va">result</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Cross-communication between two <a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a> modules is
established using several flavours of the pipe <code>%&gt;%</code>
operator, as illustrated in the following code. The first module’s
output is fed as the random number seed for the second module.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Calling app</span></span>
<span><span class="va">randomNumMod1</span> <span class="op">&lt;-</span> <span class="va">RandomNumMod</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">randomNumMod2</span> <span class="op">&lt;-</span> <span class="va">RandomNumMod</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">tagList</span><span class="op">(</span></span>
<span>  <span class="fu">fluidPage</span><span class="op">(</span></span>
<span>    <span class="va">randomNumMod1</span><span class="op">$</span><span class="fu">ui</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="va">randomNumMod2</span><span class="op">$</span><span class="fu">ui</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">randomNumMod1</span><span class="op">$</span><span class="fu">callModule</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">randomNumMod2</span><span class="op">$</span><span class="fu">callModule</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">seed_1</span> <span class="op">&lt;-</span> <span class="fu">reactive</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">observe</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">seed_1</span> <span class="op"><a href="../reference/grapes-greater-than-y-grapes.html">%&gt;1%</a></span> <span class="va">randomNumMod1</span> <span class="op"><a href="../reference/grapes-x-greater-than-y-grapes.html">%1&gt;1%</a></span> <span class="va">randomNumMod2</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">shinyApp</span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>To learn more about writing <a href="https://tm.r-forge.r-project.org/" class="external-link">tm</a> modules, read the
examples.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Mustapha Larbaoui.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
